var Qn=Object.defineProperty;var Hn=(e,n,o)=>n in e?Qn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o;var cn=(e,n,o)=>(Hn(e,typeof n!="symbol"?n+"":n,o),o);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const t of c)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(c){const t={};return c.integrity&&(t.integrity=c.integrity),c.referrerPolicy&&(t.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?t.credentials="include":c.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(c){if(c.ep)return;c.ep=!0;const t=o(c);fetch(c.href,t)}})();let v=1e-6;const Wn=new Map([[Float32Array,()=>new Float32Array(12)],[Float64Array,()=>new Float64Array(12)],[Array,()=>new Array(12).fill(0)]]);Wn.get(Float32Array);let m=Float32Array;function Kn(e){const n=m;return m=e,n}function I(e,n,o){const r=new m(3);return e!==void 0&&(r[0]=e,n!==void 0&&(r[1]=n,o!==void 0&&(r[2]=o))),r}const kn=I;function Jn(e,n,o,r){return r=r||new m(3),r[0]=e,r[1]=n,r[2]=o,r}function dn(e,n){return n=n||new m(3),n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function ne(e,n){return n=n||new m(3),n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function ee(e,n){return n=n||new m(3),n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function oe(e,n=0,o=1,r){return r=r||new m(3),r[0]=Math.min(o,Math.max(n,e[0])),r[1]=Math.min(o,Math.max(n,e[1])),r[2]=Math.min(o,Math.max(n,e[2])),r}function re(e,n,o){return o=o||new m(3),o[0]=e[0]+n[0],o[1]=e[1]+n[1],o[2]=e[2]+n[2],o}function ce(e,n,o,r){return r=r||new m(3),r[0]=e[0]+n[0]*o,r[1]=e[1]+n[1]*o,r[2]=e[2]+n[2]*o,r}function te(e,n){const o=e[0],r=e[1],c=e[2],t=e[0],i=e[1],h=e[2],a=Math.sqrt(o*o+r*r+c*c),u=Math.sqrt(t*t+i*i+h*h),p=a*u,f=p&&yn(e,n)/p;return Math.acos(f)}function un(e,n,o){return o=o||new m(3),o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],o}const ie=un;function ae(e,n){return Math.abs(e[0]-n[0])<v&&Math.abs(e[1]-n[1])<v&&Math.abs(e[2]-n[2])<v}function ue(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function fe(e,n,o,r){return r=r||new m(3),r[0]=e[0]+o*(n[0]-e[0]),r[1]=e[1]+o*(n[1]-e[1]),r[2]=e[2]+o*(n[2]-e[2]),r}function le(e,n,o,r){return r=r||new m(3),r[0]=e[0]+o[0]*(n[0]-e[0]),r[1]=e[1]+o[1]*(n[1]-e[1]),r[2]=e[2]+o[2]*(n[2]-e[2]),r}function pe(e,n,o){return o=o||new m(3),o[0]=Math.max(e[0],n[0]),o[1]=Math.max(e[1],n[1]),o[2]=Math.max(e[2],n[2]),o}function he(e,n,o){return o=o||new m(3),o[0]=Math.min(e[0],n[0]),o[1]=Math.min(e[1],n[1]),o[2]=Math.min(e[2],n[2]),o}function $n(e,n,o){return o=o||new m(3),o[0]=e[0]*n,o[1]=e[1]*n,o[2]=e[2]*n,o}const ge=$n;function ye(e,n,o){return o=o||new m(3),o[0]=e[0]/n,o[1]=e[1]/n,o[2]=e[2]/n,o}function Pn(e,n){return n=n||new m(3),n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}const Me=Pn;function k(e,n,o){o=o||new m(3);const r=e[2]*n[0]-e[0]*n[2],c=e[0]*n[1]-e[1]*n[0];return o[0]=e[1]*n[2]-e[2]*n[1],o[1]=r,o[2]=c,o}function yn(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function zn(e){const n=e[0],o=e[1],r=e[2];return Math.sqrt(n*n+o*o+r*r)}const Sn=zn;function vn(e){const n=e[0],o=e[1],r=e[2];return n*n+o*o+r*r}const xe=vn;function An(e,n){const o=e[0]-n[0],r=e[1]-n[1],c=e[2]-n[2];return Math.sqrt(o*o+r*r+c*c)}const we=An;function Un(e,n){const o=e[0]-n[0],r=e[1]-n[1],c=e[2]-n[2];return o*o+r*r+c*c}const se=Un;function K(e,n){n=n||new m(3);const o=e[0],r=e[1],c=e[2],t=Math.sqrt(o*o+r*r+c*c);return t>1e-5?(n[0]=o/t,n[1]=r/t,n[2]=c/t):(n[0]=0,n[1]=0,n[2]=0),n}function me(e,n){return n=n||new m(3),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function Tn(e,n){return n=n||new m(3),n[0]=e[0],n[1]=e[1],n[2]=e[2],n}const be=Tn;function Gn(e,n,o){return o=o||new m(3),o[0]=e[0]*n[0],o[1]=e[1]*n[1],o[2]=e[2]*n[2],o}const $e=Gn;function Bn(e,n,o){return o=o||new m(3),o[0]=e[0]/n[0],o[1]=e[1]/n[1],o[2]=e[2]/n[2],o}const Pe=Bn;function ze(e=1,n){n=n||new m(3);const o=Math.random()*2*Math.PI,r=Math.random()*2-1,c=Math.sqrt(1-r*r)*e;return n[0]=Math.cos(o)*c,n[1]=Math.sin(o)*c,n[2]=r*e,n}function Se(e){return e=e||new m(3),e[0]=0,e[1]=0,e[2]=0,e}function ve(e,n,o){o=o||new m(3);const r=e[0],c=e[1],t=e[2],i=n[3]*r+n[7]*c+n[11]*t+n[15]||1;return o[0]=(n[0]*r+n[4]*c+n[8]*t+n[12])/i,o[1]=(n[1]*r+n[5]*c+n[9]*t+n[13])/i,o[2]=(n[2]*r+n[6]*c+n[10]*t+n[14])/i,o}function Ae(e,n,o){o=o||new m(3);const r=e[0],c=e[1],t=e[2];return o[0]=r*n[0*4+0]+c*n[1*4+0]+t*n[2*4+0],o[1]=r*n[0*4+1]+c*n[1*4+1]+t*n[2*4+1],o[2]=r*n[0*4+2]+c*n[1*4+2]+t*n[2*4+2],o}function Ue(e,n,o){o=o||new m(3);const r=e[0],c=e[1],t=e[2];return o[0]=r*n[0]+c*n[4]+t*n[8],o[1]=r*n[1]+c*n[5]+t*n[9],o[2]=r*n[2]+c*n[6]+t*n[10],o}function Te(e,n,o){o=o||new m(3);const r=n[0],c=n[1],t=n[2],i=n[3]*2,h=e[0],a=e[1],u=e[2],p=c*u-t*a,f=t*h-r*u,l=r*a-c*h;return o[0]=h+p*i+(c*l-t*f)*2,o[1]=a+f*i+(t*p-r*l)*2,o[2]=u+l*i+(r*f-c*p)*2,o}function Ge(e,n){return n=n||new m(3),n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function Be(e,n,o){o=o||new m(3);const r=n*4;return o[0]=e[r+0],o[1]=e[r+1],o[2]=e[r+2],o}function Ce(e,n){n=n||new m(3);const o=e[0],r=e[1],c=e[2],t=e[4],i=e[5],h=e[6],a=e[8],u=e[9],p=e[10];return n[0]=Math.sqrt(o*o+r*r+c*c),n[1]=Math.sqrt(t*t+i*i+h*h),n[2]=Math.sqrt(a*a+u*u+p*p),n}var W=Object.freeze({__proto__:null,create:I,setDefaultType:Kn,fromValues:kn,set:Jn,ceil:dn,floor:ne,round:ee,clamp:oe,add:re,addScaled:ce,angle:te,subtract:un,sub:ie,equalsApproximately:ae,equals:ue,lerp:fe,lerpV:le,max:pe,min:he,mulScalar:$n,scale:ge,divScalar:ye,inverse:Pn,invert:Me,cross:k,dot:yn,length:zn,len:Sn,lengthSq:vn,lenSq:xe,distance:An,dist:we,distanceSq:Un,distSq:se,normalize:K,negate:me,copy:Tn,clone:be,multiply:Gn,mul:$e,divide:Bn,div:Pe,random:ze,zero:Se,transformMat4:ve,transformMat4Upper3x3:Ae,transformMat3:Ue,transformQuat:Te,getTranslation:Ge,getAxis:Be,getScaling:Ce});let b=Float32Array;function qe(e){const n=b;return b=e,n}function Ee(e,n,o,r,c,t,i,h,a,u,p,f,l,y,M,x){const g=new b(16);return e!==void 0&&(g[0]=e,n!==void 0&&(g[1]=n,o!==void 0&&(g[2]=o,r!==void 0&&(g[3]=r,c!==void 0&&(g[4]=c,t!==void 0&&(g[5]=t,i!==void 0&&(g[6]=i,h!==void 0&&(g[7]=h,a!==void 0&&(g[8]=a,u!==void 0&&(g[9]=u,p!==void 0&&(g[10]=p,f!==void 0&&(g[11]=f,l!==void 0&&(g[12]=l,y!==void 0&&(g[13]=y,M!==void 0&&(g[14]=M,x!==void 0&&(g[15]=x)))))))))))))))),g}function Oe(e,n,o,r,c,t,i,h,a,u,p,f,l,y,M,x,g){return g=g||new b(16),g[0]=e,g[1]=n,g[2]=o,g[3]=r,g[4]=c,g[5]=t,g[6]=i,g[7]=h,g[8]=a,g[9]=u,g[10]=p,g[11]=f,g[12]=l,g[13]=y,g[14]=M,g[15]=x,g}function Ve(e,n){return n=n||new b(16),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=0,n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Re(e,n){n=n||new b(16);const o=e[0],r=e[1],c=e[2],t=e[3],i=o+o,h=r+r,a=c+c,u=o*i,p=r*i,f=r*h,l=c*i,y=c*h,M=c*a,x=t*i,g=t*h,s=t*a;return n[0]=1-f-M,n[1]=p+s,n[2]=l-g,n[3]=0,n[4]=p-s,n[5]=1-u-M,n[6]=y+x,n[7]=0,n[8]=l+g,n[9]=y-x,n[10]=1-u-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Le(e,n){return n=n||new b(16),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n[4]=-e[4],n[5]=-e[5],n[6]=-e[6],n[7]=-e[7],n[8]=-e[8],n[9]=-e[9],n[10]=-e[10],n[11]=-e[11],n[12]=-e[12],n[13]=-e[13],n[14]=-e[14],n[15]=-e[15],n}function Mn(e,n){return n=n||new b(16),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}const _e=Mn;function Fe(e,n){return Math.abs(e[0]-n[0])<v&&Math.abs(e[1]-n[1])<v&&Math.abs(e[2]-n[2])<v&&Math.abs(e[3]-n[3])<v&&Math.abs(e[4]-n[4])<v&&Math.abs(e[5]-n[5])<v&&Math.abs(e[6]-n[6])<v&&Math.abs(e[7]-n[7])<v&&Math.abs(e[8]-n[8])<v&&Math.abs(e[9]-n[9])<v&&Math.abs(e[10]-n[10])<v&&Math.abs(e[11]-n[11])<v&&Math.abs(e[12]-n[12])<v&&Math.abs(e[13]-n[13])<v&&Math.abs(e[14]-n[14])<v&&Math.abs(e[15]-n[15])<v}function Ie(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]}function Cn(e){return e=e||new b(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Xe(e,n){if(n=n||new b(16),n===e){let w;return w=e[1],e[1]=e[4],e[4]=w,w=e[2],e[2]=e[8],e[8]=w,w=e[3],e[3]=e[12],e[12]=w,w=e[6],e[6]=e[9],e[9]=w,w=e[7],e[7]=e[13],e[13]=w,w=e[11],e[11]=e[14],e[14]=w,n}const o=e[0*4+0],r=e[0*4+1],c=e[0*4+2],t=e[0*4+3],i=e[1*4+0],h=e[1*4+1],a=e[1*4+2],u=e[1*4+3],p=e[2*4+0],f=e[2*4+1],l=e[2*4+2],y=e[2*4+3],M=e[3*4+0],x=e[3*4+1],g=e[3*4+2],s=e[3*4+3];return n[0]=o,n[1]=i,n[2]=p,n[3]=M,n[4]=r,n[5]=h,n[6]=f,n[7]=x,n[8]=c,n[9]=a,n[10]=l,n[11]=g,n[12]=t,n[13]=u,n[14]=y,n[15]=s,n}function qn(e,n){n=n||new b(16);const o=e[0*4+0],r=e[0*4+1],c=e[0*4+2],t=e[0*4+3],i=e[1*4+0],h=e[1*4+1],a=e[1*4+2],u=e[1*4+3],p=e[2*4+0],f=e[2*4+1],l=e[2*4+2],y=e[2*4+3],M=e[3*4+0],x=e[3*4+1],g=e[3*4+2],s=e[3*4+3],w=l*s,U=g*y,T=a*s,G=g*u,q=a*y,O=l*u,V=c*s,R=g*t,L=c*y,_=l*t,E=c*u,X=a*t,B=p*x,C=M*f,F=i*x,N=M*h,Y=i*f,rn=p*h,en=o*x,S=M*r,Z=o*f,J=p*r,d=o*h,tn=i*r,Q=w*h+G*f+q*x-(U*h+T*f+O*x),on=U*r+V*f+_*x-(w*r+R*f+L*x),xn=T*r+R*h+E*x-(G*r+V*h+X*x),wn=O*r+L*h+X*f-(q*r+_*h+E*f),D=1/(o*Q+i*on+p*xn+M*wn);return n[0]=D*Q,n[1]=D*on,n[2]=D*xn,n[3]=D*wn,n[4]=D*(U*i+T*p+O*M-(w*i+G*p+q*M)),n[5]=D*(w*o+R*p+L*M-(U*o+V*p+_*M)),n[6]=D*(G*o+V*i+X*M-(T*o+R*i+E*M)),n[7]=D*(q*o+_*i+E*p-(O*o+L*i+X*p)),n[8]=D*(B*u+N*y+Y*s-(C*u+F*y+rn*s)),n[9]=D*(C*t+en*y+J*s-(B*t+S*y+Z*s)),n[10]=D*(F*t+S*u+d*s-(N*t+en*u+tn*s)),n[11]=D*(rn*t+Z*u+tn*y-(Y*t+J*u+d*y)),n[12]=D*(F*l+rn*g+C*a-(Y*g+B*a+N*l)),n[13]=D*(Z*g+B*c+S*l-(en*l+J*g+C*c)),n[14]=D*(en*a+tn*g+N*c-(d*g+F*c+S*a)),n[15]=D*(d*l+Y*c+J*a-(Z*a+tn*l+rn*c)),n}function Ye(e){const n=e[0],o=e[0*4+1],r=e[0*4+2],c=e[0*4+3],t=e[1*4+0],i=e[1*4+1],h=e[1*4+2],a=e[1*4+3],u=e[2*4+0],p=e[2*4+1],f=e[2*4+2],l=e[2*4+3],y=e[3*4+0],M=e[3*4+1],x=e[3*4+2],g=e[3*4+3],s=f*g,w=x*l,U=h*g,T=x*a,G=h*l,q=f*a,O=r*g,V=x*c,R=r*l,L=f*c,_=r*a,E=h*c,X=s*i+T*p+G*M-(w*i+U*p+q*M),B=w*o+O*p+L*M-(s*o+V*p+R*M),C=U*o+V*i+_*M-(T*o+O*i+E*M),F=q*o+R*i+E*p-(G*o+L*i+_*p);return n*X+t*B+u*C+y*F}const Ne=qn;function En(e,n,o){o=o||new b(16);const r=e[0],c=e[1],t=e[2],i=e[3],h=e[4+0],a=e[4+1],u=e[4+2],p=e[4+3],f=e[8+0],l=e[8+1],y=e[8+2],M=e[8+3],x=e[12+0],g=e[12+1],s=e[12+2],w=e[12+3],U=n[0],T=n[1],G=n[2],q=n[3],O=n[4+0],V=n[4+1],R=n[4+2],L=n[4+3],_=n[8+0],E=n[8+1],X=n[8+2],B=n[8+3],C=n[12+0],F=n[12+1],N=n[12+2],Y=n[12+3];return o[0]=r*U+h*T+f*G+x*q,o[1]=c*U+a*T+l*G+g*q,o[2]=t*U+u*T+y*G+s*q,o[3]=i*U+p*T+M*G+w*q,o[4]=r*O+h*V+f*R+x*L,o[5]=c*O+a*V+l*R+g*L,o[6]=t*O+u*V+y*R+s*L,o[7]=i*O+p*V+M*R+w*L,o[8]=r*_+h*E+f*X+x*B,o[9]=c*_+a*E+l*X+g*B,o[10]=t*_+u*E+y*X+s*B,o[11]=i*_+p*E+M*X+w*B,o[12]=r*C+h*F+f*N+x*Y,o[13]=c*C+a*F+l*N+g*Y,o[14]=t*C+u*F+y*N+s*Y,o[15]=i*C+p*F+M*N+w*Y,o}const De=En;function je(e,n,o){return o=o||Cn(),e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11]),o[12]=n[0],o[13]=n[1],o[14]=n[2],o[15]=1,o}function Ze(e,n){return n=n||I(),n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function Qe(e,n,o){o=o||I();const r=n*4;return o[0]=e[r+0],o[1]=e[r+1],o[2]=e[r+2],o}function He(e,n,o,r){r!==e&&(r=Mn(e,r));const c=o*4;return r[c+0]=n[0],r[c+1]=n[1],r[c+2]=n[2],r}function We(e,n){n=n||I();const o=e[0],r=e[1],c=e[2],t=e[4],i=e[5],h=e[6],a=e[8],u=e[9],p=e[10];return n[0]=Math.sqrt(o*o+r*r+c*c),n[1]=Math.sqrt(t*t+i*i+h*h),n[2]=Math.sqrt(a*a+u*u+p*p),n}function Ke(e,n,o,r,c){c=c||new b(16);const t=Math.tan(Math.PI*.5-.5*e);if(c[0]=t/n,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=t,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,r===1/0)c[10]=-1,c[14]=-o;else{const i=1/(o-r);c[10]=r*i,c[14]=r*o*i}return c}function ke(e,n,o,r,c,t,i){return i=i||new b(16),i[0]=2/(n-e),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(r-o),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1/(c-t),i[11]=0,i[12]=(n+e)/(e-n),i[13]=(r+o)/(o-r),i[14]=c/(c-t),i[15]=1,i}function Je(e,n,o,r,c,t,i){i=i||new b(16);const h=n-e,a=r-o,u=c-t;return i[0]=2*c/h,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*c/a,i[6]=0,i[7]=0,i[8]=(e+n)/h,i[9]=(r+o)/a,i[10]=t/u,i[11]=-1,i[12]=0,i[13]=0,i[14]=c*t/u,i[15]=0,i}let P,A,$;function de(e,n,o,r){return r=r||new b(16),P=P||I(),A=A||I(),$=$||I(),K(un(n,e,$),$),K(k(o,$,P),P),K(k($,P,A),A),r[0]=P[0],r[1]=P[1],r[2]=P[2],r[3]=0,r[4]=A[0],r[5]=A[1],r[6]=A[2],r[7]=0,r[8]=$[0],r[9]=$[1],r[10]=$[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function no(e,n,o,r){return r=r||new b(16),P=P||I(),A=A||I(),$=$||I(),K(un(e,n,$),$),K(k(o,$,P),P),K(k($,P,A),A),r[0]=P[0],r[1]=P[1],r[2]=P[2],r[3]=0,r[4]=A[0],r[5]=A[1],r[6]=A[2],r[7]=0,r[8]=$[0],r[9]=$[1],r[10]=$[2],r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function eo(e,n,o,r){return r=r||new b(16),P=P||I(),A=A||I(),$=$||I(),K(un(e,n,$),$),K(k(o,$,P),P),K(k($,P,A),A),r[0]=P[0],r[1]=A[0],r[2]=$[0],r[3]=0,r[4]=P[1],r[5]=A[1],r[6]=$[1],r[7]=0,r[8]=P[2],r[9]=A[2],r[10]=$[2],r[11]=0,r[12]=-(P[0]*e[0]+P[1]*e[1]+P[2]*e[2]),r[13]=-(A[0]*e[0]+A[1]*e[1]+A[2]*e[2]),r[14]=-($[0]*e[0]+$[1]*e[1]+$[2]*e[2]),r[15]=1,r}function oo(e,n){return n=n||new b(16),n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function ro(e,n,o){o=o||new b(16);const r=n[0],c=n[1],t=n[2],i=e[0],h=e[1],a=e[2],u=e[3],p=e[1*4+0],f=e[1*4+1],l=e[1*4+2],y=e[1*4+3],M=e[2*4+0],x=e[2*4+1],g=e[2*4+2],s=e[2*4+3],w=e[3*4+0],U=e[3*4+1],T=e[3*4+2],G=e[3*4+3];return e!==o&&(o[0]=i,o[1]=h,o[2]=a,o[3]=u,o[4]=p,o[5]=f,o[6]=l,o[7]=y,o[8]=M,o[9]=x,o[10]=g,o[11]=s),o[12]=i*r+p*c+M*t+w,o[13]=h*r+f*c+x*t+U,o[14]=a*r+l*c+g*t+T,o[15]=u*r+y*c+s*t+G,o}function co(e,n){n=n||new b(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=r,n[7]=0,n[8]=0,n[9]=-r,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function to(e,n,o){o=o||new b(16);const r=e[4],c=e[5],t=e[6],i=e[7],h=e[8],a=e[9],u=e[10],p=e[11],f=Math.cos(n),l=Math.sin(n);return o[4]=f*r+l*h,o[5]=f*c+l*a,o[6]=f*t+l*u,o[7]=f*i+l*p,o[8]=f*h-l*r,o[9]=f*a-l*c,o[10]=f*u-l*t,o[11]=f*p-l*i,e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function io(e,n){n=n||new b(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=o,n[1]=0,n[2]=-r,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=r,n[9]=0,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ao(e,n,o){o=o||new b(16);const r=e[0*4+0],c=e[0*4+1],t=e[0*4+2],i=e[0*4+3],h=e[2*4+0],a=e[2*4+1],u=e[2*4+2],p=e[2*4+3],f=Math.cos(n),l=Math.sin(n);return o[0]=f*r-l*h,o[1]=f*c-l*a,o[2]=f*t-l*u,o[3]=f*i-l*p,o[8]=f*h+l*r,o[9]=f*a+l*c,o[10]=f*u+l*t,o[11]=f*p+l*i,e!==o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function uo(e,n){n=n||new b(16);const o=Math.cos(e),r=Math.sin(e);return n[0]=o,n[1]=r,n[2]=0,n[3]=0,n[4]=-r,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function fo(e,n,o){o=o||new b(16);const r=e[0*4+0],c=e[0*4+1],t=e[0*4+2],i=e[0*4+3],h=e[1*4+0],a=e[1*4+1],u=e[1*4+2],p=e[1*4+3],f=Math.cos(n),l=Math.sin(n);return o[0]=f*r+l*h,o[1]=f*c+l*a,o[2]=f*t+l*u,o[3]=f*i+l*p,o[4]=f*h-l*r,o[5]=f*a-l*c,o[6]=f*u-l*t,o[7]=f*p-l*i,e!==o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function On(e,n,o){o=o||new b(16);let r=e[0],c=e[1],t=e[2];const i=Math.sqrt(r*r+c*c+t*t);r/=i,c/=i,t/=i;const h=r*r,a=c*c,u=t*t,p=Math.cos(n),f=Math.sin(n),l=1-p;return o[0]=h+(1-h)*p,o[1]=r*c*l+t*f,o[2]=r*t*l-c*f,o[3]=0,o[4]=r*c*l-t*f,o[5]=a+(1-a)*p,o[6]=c*t*l+r*f,o[7]=0,o[8]=r*t*l+c*f,o[9]=c*t*l-r*f,o[10]=u+(1-u)*p,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}const lo=On;function Vn(e,n,o,r){r=r||new b(16);let c=n[0],t=n[1],i=n[2];const h=Math.sqrt(c*c+t*t+i*i);c/=h,t/=h,i/=h;const a=c*c,u=t*t,p=i*i,f=Math.cos(o),l=Math.sin(o),y=1-f,M=a+(1-a)*f,x=c*t*y+i*l,g=c*i*y-t*l,s=c*t*y-i*l,w=u+(1-u)*f,U=t*i*y+c*l,T=c*i*y+t*l,G=t*i*y-c*l,q=p+(1-p)*f,O=e[0],V=e[1],R=e[2],L=e[3],_=e[4],E=e[5],X=e[6],B=e[7],C=e[8],F=e[9],N=e[10],Y=e[11];return r[0]=M*O+x*_+g*C,r[1]=M*V+x*E+g*F,r[2]=M*R+x*X+g*N,r[3]=M*L+x*B+g*Y,r[4]=s*O+w*_+U*C,r[5]=s*V+w*E+U*F,r[6]=s*R+w*X+U*N,r[7]=s*L+w*B+U*Y,r[8]=T*O+G*_+q*C,r[9]=T*V+G*E+q*F,r[10]=T*R+G*X+q*N,r[11]=T*L+G*B+q*Y,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r}const po=Vn;function ho(e,n){return n=n||new b(16),n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function go(e,n,o){o=o||new b(16);const r=n[0],c=n[1],t=n[2];return o[0]=r*e[0*4+0],o[1]=r*e[0*4+1],o[2]=r*e[0*4+2],o[3]=r*e[0*4+3],o[4]=c*e[1*4+0],o[5]=c*e[1*4+1],o[6]=c*e[1*4+2],o[7]=c*e[1*4+3],o[8]=t*e[2*4+0],o[9]=t*e[2*4+1],o[10]=t*e[2*4+2],o[11]=t*e[2*4+3],e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function yo(e,n){return n=n||new b(16),n[0]=e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Mo(e,n,o){return o=o||new b(16),o[0]=n*e[0*4+0],o[1]=n*e[0*4+1],o[2]=n*e[0*4+2],o[3]=n*e[0*4+3],o[4]=n*e[1*4+0],o[5]=n*e[1*4+1],o[6]=n*e[1*4+2],o[7]=n*e[1*4+3],o[8]=n*e[2*4+0],o[9]=n*e[2*4+1],o[10]=n*e[2*4+2],o[11]=n*e[2*4+3],e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}var nn=Object.freeze({__proto__:null,setDefaultType:qe,create:Ee,set:Oe,fromMat3:Ve,fromQuat:Re,negate:Le,copy:Mn,clone:_e,equalsApproximately:Fe,equals:Ie,identity:Cn,transpose:Xe,inverse:qn,determinant:Ye,invert:Ne,multiply:En,mul:De,setTranslation:je,getTranslation:Ze,getAxis:Qe,setAxis:He,getScaling:We,perspective:Ke,ortho:ke,frustum:Je,aim:de,cameraAim:no,lookAt:eo,translation:oo,translate:ro,rotationX:co,rotateX:to,rotationY:io,rotateY:ao,rotationZ:uo,rotateZ:fo,axisRotation:On,rotation:lo,axisRotate:Vn,rotate:po,scaling:ho,scale:go,uniformScaling:yo,uniformScale:Mo});let z=Float32Array;function xo(e){const n=z;return z=e,n}function Rn(e,n,o,r){const c=new z(4);return e!==void 0&&(c[0]=e,n!==void 0&&(c[1]=n,o!==void 0&&(c[2]=o,r!==void 0&&(c[3]=r)))),c}const wo=Rn;function so(e,n,o,r,c){return c=c||new z(4),c[0]=e,c[1]=n,c[2]=o,c[3]=r,c}function Ln(e,n,o){o=o||new z(4);const r=n*.5,c=Math.sin(r);return o[0]=c*e[0],o[1]=c*e[1],o[2]=c*e[2],o[3]=Math.cos(r),o}function mo(e,n){n=n||I(4);const o=Math.acos(e[3])*2,r=Math.sin(o*.5);return r>v?(n[0]=e[0]/r,n[1]=e[1]/r,n[2]=e[2]/r):(n[0]=1,n[1]=0,n[2]=0),{angle:o,axis:n}}function bo(e,n){const o=Yn(e,n);return Math.acos(2*o*o-1)}function _n(e,n,o){o=o||new z(4);const r=e[0],c=e[1],t=e[2],i=e[3],h=n[0],a=n[1],u=n[2],p=n[3];return o[0]=r*p+i*h+c*u-t*a,o[1]=c*p+i*a+t*h-r*u,o[2]=t*p+i*u+r*a-c*h,o[3]=i*p-r*h-c*a-t*u,o}const $o=_n;function Po(e,n,o){o=o||new z(4);const r=n*.5,c=e[0],t=e[1],i=e[2],h=e[3],a=Math.sin(r),u=Math.cos(r);return o[0]=c*u+h*a,o[1]=t*u+i*a,o[2]=i*u-t*a,o[3]=h*u-c*a,o}function zo(e,n,o){o=o||new z(4);const r=n*.5,c=e[0],t=e[1],i=e[2],h=e[3],a=Math.sin(r),u=Math.cos(r);return o[0]=c*u-i*a,o[1]=t*u+h*a,o[2]=i*u+c*a,o[3]=h*u-t*a,o}function So(e,n,o){o=o||new z(4);const r=n*.5,c=e[0],t=e[1],i=e[2],h=e[3],a=Math.sin(r),u=Math.cos(r);return o[0]=c*u+t*a,o[1]=t*u-c*a,o[2]=i*u+h*a,o[3]=h*u-i*a,o}function pn(e,n,o,r){r=r||new z(4);const c=e[0],t=e[1],i=e[2],h=e[3];let a=n[0],u=n[1],p=n[2],f=n[3],l=c*a+t*u+i*p+h*f;l<0&&(l=-l,a=-a,u=-u,p=-p,f=-f);let y,M;if(1-l>v){const x=Math.acos(l),g=Math.sin(x);y=Math.sin((1-o)*x)/g,M=Math.sin(o*x)/g}else y=1-o,M=o;return r[0]=y*c+M*a,r[1]=y*t+M*u,r[2]=y*i+M*p,r[3]=y*h+M*f,r}function vo(e,n){n=n||new z(4);const o=e[0],r=e[1],c=e[2],t=e[3],i=o*o+r*r+c*c+t*t,h=i?1/i:0;return n[0]=-o*h,n[1]=-r*h,n[2]=-c*h,n[3]=t*h,n}function Ao(e,n){return n=n||new z(4),n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function Uo(e,n){n=n||new z(4);const o=e[0]+e[5]+e[10];if(o>0){const r=Math.sqrt(o+1);n[3]=.5*r;const c=.5/r;n[0]=(e[6]-e[9])*c,n[1]=(e[8]-e[2])*c,n[2]=(e[1]-e[4])*c}else{let r=0;e[5]>e[0]&&(r=1),e[10]>e[r*4+r]&&(r=2);const c=(r+1)%3,t=(r+2)%3,i=Math.sqrt(e[r*4+r]-e[c*4+c]-e[t*4+t]+1);n[r]=.5*i;const h=.5/i;n[3]=(e[c*4+t]-e[t*4+c])*h,n[c]=(e[c*4+r]+e[r*4+c])*h,n[t]=(e[t*4+r]+e[r*4+t])*h}return n}function To(e,n,o,r,c){c=c||new z(4);const t=e*.5,i=n*.5,h=o*.5,a=Math.sin(t),u=Math.cos(t),p=Math.sin(i),f=Math.cos(i),l=Math.sin(h),y=Math.cos(h);switch(r){case"xyz":c[0]=a*f*y+u*p*l,c[1]=u*p*y-a*f*l,c[2]=u*f*l+a*p*y,c[3]=u*f*y-a*p*l;break;case"xzy":c[0]=a*f*y-u*p*l,c[1]=u*p*y-a*f*l,c[2]=u*f*l+a*p*y,c[3]=u*f*y+a*p*l;break;case"yxz":c[0]=a*f*y+u*p*l,c[1]=u*p*y-a*f*l,c[2]=u*f*l-a*p*y,c[3]=u*f*y+a*p*l;break;case"yzx":c[0]=a*f*y+u*p*l,c[1]=u*p*y+a*f*l,c[2]=u*f*l-a*p*y,c[3]=u*f*y-a*p*l;break;case"zxy":c[0]=a*f*y-u*p*l,c[1]=u*p*y+a*f*l,c[2]=u*f*l+a*p*y,c[3]=u*f*y-a*p*l;break;case"zyx":c[0]=a*f*y-u*p*l,c[1]=u*p*y+a*f*l,c[2]=u*f*l-a*p*y,c[3]=u*f*y+a*p*l;break;default:throw new Error(`Unknown rotation order: ${r}`)}return c}function Fn(e,n){return n=n||new z(4),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}const Go=Fn;function Bo(e,n,o){return o=o||new z(4),o[0]=e[0]+n[0],o[1]=e[1]+n[1],o[2]=e[2]+n[2],o[3]=e[3]+n[3],o}function In(e,n,o){return o=o||new z(4),o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],o[3]=e[3]-n[3],o}const Co=In;function Xn(e,n,o){return o=o||new z(4),o[0]=e[0]*n,o[1]=e[1]*n,o[2]=e[2]*n,o[3]=e[3]*n,o}const qo=Xn;function Eo(e,n,o){return o=o||new z(4),o[0]=e[0]/n,o[1]=e[1]/n,o[2]=e[2]/n,o[3]=e[3]/n,o}function Yn(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}function Oo(e,n,o,r){return r=r||new z(4),r[0]=e[0]+o*(n[0]-e[0]),r[1]=e[1]+o*(n[1]-e[1]),r[2]=e[2]+o*(n[2]-e[2]),r[3]=e[3]+o*(n[3]-e[3]),r}function Nn(e){const n=e[0],o=e[1],r=e[2],c=e[3];return Math.sqrt(n*n+o*o+r*r+c*c)}const Vo=Nn;function Dn(e){const n=e[0],o=e[1],r=e[2],c=e[3];return n*n+o*o+r*r+c*c}const Ro=Dn;function jn(e,n){n=n||new z(4);const o=e[0],r=e[1],c=e[2],t=e[3],i=Math.sqrt(o*o+r*r+c*c+t*t);return i>1e-5?(n[0]=o/i,n[1]=r/i,n[2]=c/i,n[3]=t/i):(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Lo(e,n){return Math.abs(e[0]-n[0])<v&&Math.abs(e[1]-n[1])<v&&Math.abs(e[2]-n[2])<v&&Math.abs(e[3]-n[3])<v}function _o(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]}function Fo(e){return e=e||new z(4),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}let H,hn,gn;function Io(e,n,o){o=o||new z(4),H=H||I(),hn=hn||I(1,0,0),gn=gn||I(0,1,0);const r=yn(e,n);return r<-.999999?(k(hn,e,H),Sn(H)<1e-6&&k(gn,e,H),K(H,H),Ln(H,Math.PI,o),o):r>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(k(e,n,H),o[0]=H[0],o[1]=H[1],o[2]=H[2],o[3]=1+r,jn(o,o))}let fn,ln;function Xo(e,n,o,r,c,t){return t=t||new z(4),fn=fn||new z(4),ln=ln||new z(4),pn(e,r,c,fn),pn(n,o,c,ln),pn(fn,ln,2*c*(1-c),t),t}var an=Object.freeze({__proto__:null,create:Rn,setDefaultType:xo,fromValues:wo,set:so,fromAxisAngle:Ln,toAxisAngle:mo,angle:bo,multiply:_n,mul:$o,rotateX:Po,rotateY:zo,rotateZ:So,slerp:pn,inverse:vo,conjugate:Ao,fromMat:Uo,fromEuler:To,copy:Fn,clone:Go,add:Bo,subtract:In,sub:Co,mulScalar:Xn,scale:qo,divScalar:Eo,dot:Yn,lerp:Oo,length:Nn,len:Vo,lengthSq:Dn,lenSq:Ro,normalize:jn,equalsApproximately:Lo,equals:_o,identity:Fo,rotationTo:Io,sqlerp:Xo});class Yo{constructor(n,o=10){cn(this,"currentRotation",an.identity());cn(this,"targetRotation",an.identity());cn(this,"perspectiveViewMatrix",nn.create());cn(this,"projectionMatrix",nn.create());cn(this,"perspective",nn.create());this.radius=o,nn.perspective(2*Math.PI/5,n,.1,1e3,this.perspective),this.updatePerspectiveView(),this.updateProjection()}update(n){return an.slerp(this.currentRotation,this.targetRotation,n,this.currentRotation),this.updateProjection(),this.projectionMatrix}zoom(n){this.radius=Math.min(Math.max(this.radius+n,1),100),this.updatePerspectiveView()}rotate(n,o,r){const c=an.fromEuler(n,o,r,"xyz");an.multiply(c,this.targetRotation,this.targetRotation)}updatePerspectiveView(){const n=W.create(0,0,this.radius),o=W.create(0,1,0),r=W.create(0,0,0),c=nn.lookAt(n,r,o);nn.multiply(this.perspective,c,this.perspectiveViewMatrix)}updateProjection(){const n=nn.fromQuat(this.currentRotation);nn.multiply(this.perspectiveViewMatrix,n,this.projectionMatrix)}}const sn=new Float32Array([1,-1,1,0,1,-1,-1,1,1,1,-1,-1,-1,1,0,1,-1,-1,0,0,1,-1,1,0,1,-1,-1,-1,1,0,1,1,1,0,1,1,-1,1,1,1,1,-1,-1,1,0,1,1,-1,0,0,1,1,1,0,1,1,-1,-1,1,0,-1,1,1,0,1,1,1,1,1,1,1,1,-1,1,0,-1,1,-1,0,0,-1,1,1,0,1,1,1,-1,1,0,-1,-1,1,0,1,-1,1,1,1,1,-1,1,-1,1,0,-1,-1,-1,0,0,-1,-1,1,0,1,-1,1,-1,1,0,1,1,1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,1,0,1,-1,1,0,0,1,1,1,0,1,1,-1,-1,0,1,-1,-1,-1,1,1,-1,1,-1,1,0,1,1,-1,0,0,1,-1,-1,0,1,-1,1,-1,1,0]),No="/assets/nx-838cce23.png",Do="/assets/ny-1907f0dd.png",jo="/assets/nz-2bedcd73.png",Zo="/assets/px-b969ea0a.png",Qo="/assets/py-bbc685a6.png",Ho="/assets/pz-3d49efe5.png";function Wo(e,n){return([o,r])=>{o*=Math.PI*2,r*=Math.PI*2;const c=W.create(Math.sin(o)+2*Math.sin(2*o),Math.cos(o)-2*Math.cos(2*o),-Math.sin(3*o)),t=W.create(Math.cos(o)+4*Math.cos(2*o),-Math.sin(o)+4*Math.sin(2*o),-3*Math.cos(3*o)),i=W.create(-Math.sin(o)-8*Math.sin(2*o),-Math.cos(o)+8*Math.cos(2*o),9*Math.sin(3*o)),h=W.cross(i,t);return W.normalize(i,i),W.normalize(h,h),W.scale(c,e,c),W.addScaled(c,i,Math.cos(r)*n,c),W.addScaled(c,h,Math.sin(r)*n,c),c}}const Ko=`@group(0) @binding(1) var mySampler: sampler;\r
@group(0) @binding(2) var myTexture: texture_cube<f32>;\r
\r
@fragment\r
fn main(\r
  @location(0) fragUV: vec2<f32>,\r
  @location(1) fragPosition: vec4<f32>\r
) -> @location(0) vec4<f32> {\r
  // Our camera and the skybox cube are both centered at (0, 0, 0)\r
  // so we can use the cube geomtry position to get viewing vector to sample the cube texture.\r
  // The magnitude of the vector doesn't matter.\r
  var cubemapVec = fragPosition.xyz - vec3(0.5);\r
  return textureSample(myTexture, mySampler, cubemapVec);\r
}\r
`,ko=`@binding(0) @group(0) var<uniform> matrix: mat4x4<f32>;\r
\r
struct Out {\r
  @builtin(position) pos : vec4<f32>,\r
  @location(0) fragUV : vec2<f32>,\r
  @location(1) fragPosition: vec4<f32>,\r
}\r
\r
@vertex\r
fn main(\r
  @location(0) pos : vec3<f32>,\r
  @location(1) uv : vec2<f32>\r
) -> Out {\r
  var output : Out;\r
  output.pos = matrix * vec4(pos, 0.01);\r
  \r
  output.fragUV = uv;\r
  output.fragPosition = 0.5 * (vec4(pos, 1.0) + vec4(1.0, 1.0, 1.0, 1.0));\r
  return output;\r
}\r
`,Jo=`@binding(0) @group(0) var<storage, read> size: vec2<u32>;\r
@binding(1) @group(0) var<storage, read> current: array<u32>;\r
@binding(2) @group(0) var<storage, read_write> next: array<u32>;\r
\r
fn getIndex(x: u32, y: u32) -> u32 {\r
  let h = size.y;\r
  let w = size.x;\r
\r
  return (y % h) * w + (x % w);\r
}\r
\r
fn getCell(x: u32, y: u32) -> u32 {\r
  return current[getIndex(x, y)];\r
}\r
\r
fn countNeighbors(x: u32, y: u32) -> u32 {\r
  return getCell(x - 1, y - 1) + getCell(x, y - 1) + getCell(x + 1, y - 1) + \r
         getCell(x - 1, y) +                         getCell(x + 1, y) + \r
         getCell(x - 1, y + 1) + getCell(x, y + 1) + getCell(x + 1, y + 1);\r
}\r
\r
@compute @workgroup_size(8, 8)\r
fn main(@builtin(global_invocation_id) grid: vec3<u32>) {\r
  let x = grid.x;\r
  let y = grid.y;\r
  let n = countNeighbors(x, y);\r
  next[getIndex(x, y)] = select(u32(n == 3u), u32(n == 2u || n == 3u), getCell(x, y) == 1u); \r
} \r
`,nr=`@binding(1) @group(0) var<uniform> size : vec2<u32>;\r
@binding(2) @group(0) var<storage, read> current: array<u32>;\r
@binding(3) @group(0) var<storage, read_write> next: array<u32>;\r
\r
@fragment\r
fn main(\r
  @location(0) cell: f32,\r
  @location(1) color: vec3<f32>,\r
) -> @location(0) vec4<f32> {\r
  return vec4(cell * color, 1.0);\r
}\r
`,er=`@binding(0) @group(0) var<uniform> view : mat4x4<f32>;\r
@binding(1) @group(0) var<uniform> size : vec2<u32>;\r
\r
struct Out {\r
  @builtin(position) pos: vec4<f32>,\r
  @location(0) cell: f32,\r
  @location(1) color: vec3<f32>,\r
}\r
\r
@vertex\r
fn main(\r
  @builtin(instance_index) i: u32,\r
  @location(0) pos: vec4<f32>,\r
  @location(1) cell: u32,\r
  @location(2) color: vec3<f32>,\r
  @location(3) bl: vec3<f32>,\r
  @location(4) tl: vec3<f32>,\r
  @location(5) br: vec3<f32>,\r
  @location(6) tr: vec3<f32>,\r
) -> Out {\r
  let model = mat4x4<f32>(\r
    bl.x, bl.y, bl.z, 1.0,\r
    tl.x, tl.y, tl.z, 1.0,\r
    br.x, br.y, br.z, 1.0,\r
    tr.x, tr.y, tr.z, 1.0\r
  );\r
\r
  var output : Out;\r
\r
  output.pos = view * model * pos;\r
  output.cell = f32(cell);\r
  output.color = color;\r
  return output;\r
}`;function or(e,n,o){let r=n*Math.min(o,1-o),c=(t,i=(t+e/30)%12)=>o-r*Math.max(Math.min(i-3,9-i,1),-1);return[c(0),c(8),c(4)]}function rr(e,n,o){const r=new Float32Array(n*o*15);for(let c=0;c<n;c++)for(let t=0;t<o;t++){const i=c/n,h=(c+1)/n,a=t/o,u=(t+1)/o,p=or(i*360,1,.5),f=(c+t*n)*15;r.set(p,f),r.set(e([i,u]),f+3),r.set(e([i,a]),f+6),r.set(e([h,u]),f+9),r.set(e([h,a]),f+12)}return r}function mn(e,n){if(!e)throw new Error(n)}const j=document.getElementById("surface"),Zn=window.devicePixelRatio||1;j.width=j.clientWidth*Zn;j.height=j.clientHeight*Zn;const bn=j.getContext("webgpu");async function cr(){mn(navigator.gpu,"WebGPU not supported.");const e=await navigator.gpu.requestAdapter();mn(e,"Couldn't request WebGPU adapter.");const n=await e.requestDevice(),o=navigator.gpu.getPreferredCanvasFormat();bn.configure({device:n,format:o,alphaMode:"premultiplied"});const r=700,c=100,t=rr(Wo(1,.5),r,c),i=n.createBuffer({size:t.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Float32Array(i.getMappedRange()).set(t),i.unmap();const h=n.createBuffer({size:4*4*4,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),a=n.createBuffer({size:sn.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(a.getMappedRange()).set(sn),a.unmap();const u=n.createRenderPipeline({layout:"auto",vertex:{module:n.createShaderModule({code:ko}),entryPoint:"main",buffers:[{arrayStride:20,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x2"}]}]},fragment:{module:n.createShaderModule({code:Ko}),entryPoint:"main",targets:[{format:o}]},primitive:{topology:"triangle-list",cullMode:"none"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}}),p=await Promise.all([Zo,No,Qo,Do,Ho,jo].map(async S=>{const Z=await fetch(S);return createImageBitmap(await Z.blob())})),f=n.createTexture({dimension:"2d",size:{width:p[0].width,height:p[0].height,depthOrArrayLayers:p.length},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});for(let S=0;S<p.length;S++){const Z=p[S];n.queue.copyExternalImageToTexture({source:Z},{texture:f,origin:[0,0,S]},{width:Z.width,height:Z.height})}const l=n.createSampler({magFilter:"linear",minFilter:"linear"}),y=n.createBindGroup({layout:u.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:h}},{binding:1,resource:l},{binding:2,resource:f.createView({dimension:"cube"})}]}),M=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),x=n.createBuffer({size:M.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(x.getMappedRange()).set(M),x.unmap();const g=n.createBuffer({size:8,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,mappedAtCreation:!0});new Uint32Array(g.getMappedRange()).set([r,c]),g.unmap();const s=new Uint32Array(r*c);s.fill(0);for(let S=0;S<s.length;S++)s[S]=Math.random()<.25?1:0;const w=n.createBuffer({size:s.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC,mappedAtCreation:!0});new Uint32Array(w.getMappedRange()).set(s),w.unmap();const U=n.createBuffer({size:s.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC}),T=n.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),G=n.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]}),q=n.createBindGroup({layout:T,entries:[{binding:0,resource:{buffer:g}},{binding:1,resource:{buffer:w}},{binding:2,resource:{buffer:U}}]}),O=n.createBindGroup({layout:T,entries:[{binding:0,resource:{buffer:g}},{binding:1,resource:{buffer:U}},{binding:2,resource:{buffer:w}}]}),V=n.createBindGroup({layout:G,entries:[{binding:0,resource:{buffer:h}},{binding:1,resource:{buffer:g}}]}),R=n.createComputePipeline({layout:n.createPipelineLayout({bindGroupLayouts:[T]}),compute:{module:n.createShaderModule({code:Jo}),entryPoint:"main"}}),L=n.createRenderPipeline({layout:n.createPipelineLayout({bindGroupLayouts:[G]}),vertex:{module:n.createShaderModule({code:er}),entryPoint:"main",buffers:[{stepMode:"vertex",arrayStride:16,attributes:[{offset:0,shaderLocation:0,format:"float32x4"}]},{stepMode:"instance",arrayStride:4,attributes:[{offset:0,shaderLocation:1,format:"uint32"}]},{stepMode:"instance",arrayStride:60,attributes:[{offset:0,shaderLocation:2,format:"float32x3"},{offset:12,shaderLocation:3,format:"float32x3"},{offset:24,shaderLocation:4,format:"float32x3"},{offset:36,shaderLocation:5,format:"float32x3"},{offset:48,shaderLocation:6,format:"float32x3"}]}]},fragment:{module:n.createShaderModule({code:nr}),entryPoint:"main",targets:[{format:o}]},primitive:{topology:"triangle-strip",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}}),_=n.createTexture({size:{width:j.width,height:j.height},format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),E={loadOp:"clear",storeOp:"store",view:void 0},X={colorAttachments:[E],depthStencilAttachment:{view:_.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}},B=new Yo(j.width/j.height);let C=!1;j.onmousedown=()=>C=!0,j.onmouseup=()=>C=!1,j.onmouseleave=()=>C=!1,j.onmousemove=S=>{C&&B.rotate(S.movementY/j.height*Math.PI,S.movementX/j.width*Math.PI,0)},j.onwheel=S=>{B.zoom(S.deltaY/100)};let F=performance.now(),N=performance.now(),Y=0;const rn=100;function en(){const S=performance.now(),Z=(S-F)*.001;F=S,E.view=bn.getCurrentTexture().createView(),B.rotate(Z*.1,Z*.1,Z*.1);const J=B.update(Z*10);n.queue.writeBuffer(h,0,J.buffer,J.byteOffset,J.byteLength);const d=n.createCommandEncoder();if(S-N>rn){N=S;const on=d.beginComputePass();on.setPipeline(R),on.setBindGroup(0,Y%2?O:q),on.dispatchWorkgroups(Math.ceil(r/8),Math.ceil(c/8)),on.end(),Y++}const Q=d.beginRenderPass(X);Q.setPipeline(L),Q.setVertexBuffer(0,x),Q.setVertexBuffer(1,Y%2?U:w),Q.setVertexBuffer(2,i),Q.setBindGroup(0,V),Q.draw(4,r*c),Q.setPipeline(u),Q.setVertexBuffer(0,a),Q.setBindGroup(0,y),Q.draw(36),Q.end(),n.queue.submit([d.finish()]),requestAnimationFrame(en)}requestAnimationFrame(en)}cr();
